<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windows 98</title>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <style>
        :root{--surface:#c0c0c0;--text:#222;--highlight:#fff;--shadow:#808080;--frame:#0a0a0a;--blue:#000080;--blue-light:#1084d0;--link-blue:#00f;--border-raised:inset -1px -1px var(--frame),inset 1px 1px var(--highlight),inset -2px -2px var(--shadow),inset 2px 2px var(--surface);--border-sunken:inset -1px -1px var(--highlight),inset 1px 1px var(--frame),inset -2px -2px var(--surface),inset 2px 2px var(--shadow);--border-window:inset -1px -1px var(--frame),inset 1px 1px var(--surface),inset -2px -2px var(--shadow),inset 2px 2px var(--highlight);}
        @font-face{font-family:"Pixelated MS Sans Serif";src:url("https://win98icons.alexmeub.com/fonts/ms_sans_serif.woff2");}
        body{font-family:"Pixelated MS Sans Serif",Arial;-webkit-font-smoothing:none;font-size:11px;background:#008080;overflow:hidden;margin:0;height:100vh;display:flex;flex-direction:column;overflow: hidden;}
        button,input[type=submit],input[type=reset]{box-sizing:border-box;border:none;color:var(--text);background:var(--surface);box-shadow:var(--border-raised);min-width:75px;min-height:23px;padding:0 12px;}
        button:not(:disabled):active,input[type=submit]:not(:disabled):active,input[type=reset]:not(:disabled):active{box-shadow:var(--border-sunken);text-shadow:1px 1px var(--text);}
        button:focus{outline:1px dotted var(--frame);outline-offset:-4px;}
        .window{box-shadow:var(--border-window);background:var(--surface);padding:3px;position:absolute;top:100px;left:150px;width:400px;min-width:200px;min-height:150px;display:flex;flex-direction:column;z-index:100;}
        .window.maximized{top:0!important;left:0!important;width:100%!important;height:calc(100vh - 30px)!important;}
        .title-bar{background:linear-gradient(90deg,var(--blue),var(--blue-light));padding:3px 2px 3px 3px;display:flex;justify-content:space-between;align-items:center;cursor:grab;}
        .title-bar:active{cursor:grabbing;}
        .title-bar-text{font-weight:bold;color:#fff;margin-right:24px;}
        .title-bar-controls{display:flex;}
        .title-bar-controls button{padding:0;min-width:16px;min-height:14px;margin-left:2px;}
        .title-bar-controls svg{stroke:var(--frame);stroke-width:1.5;fill:none;}
        .window-body{margin:8px;flex-grow:1;background:#fff;box-shadow:var(--border-sunken);padding:10px;overflow:hidden;}
        .desktop{flex-grow:1;position:relative;padding:10px;}
        .desktop-icon{display:flex;flex-direction:column;align-items:center;width:80px;cursor:pointer;text-align:center;position: absolute;}
        .desktop-icon:focus{outline:1px dotted var(--frame);}
        .desktop-icon img{width:32px;height:32px;margin-bottom:5px;}
        .desktop-icon span{color:#fff;background-color:transparent;padding:2px;}
        .desktop-icon:focus span{background-color:var(--blue);}
        .taskbar{height:30px;background:var(--surface);border-top:1px solid var(--highlight);box-shadow:inset 0 1px 0 var(--surface);display:flex;align-items:center;padding:2px;z-index:200;}
        .start-button{min-width:70px;font-weight:bold;display:flex;align-items:center;gap:5px;padding:0 5px;}
        .start-button img{width:20px;height:20px;}
        .time-date{margin-left:auto;border:1px solid var(--shadow);border-right-color:var(--highlight);border-bottom-color:var(--highlight);padding:2px 8px;font-family:'VT323',monospace;font-size:14px;}
        .vertical-separator{width:1px;height:100%;background-color:var(--shadow);border-right:1px solid var(--highlight);margin:0 4px;}
        .taskbar-btn{min-width:100px;font-weight:bold;display:flex;align-items:center;padding:0 5px;}
        .taskbar-btn:not(:disabled):active{box-shadow:var(--border-sunken) !important;}
        .start-menu{position: absolute; bottom: 30px; left: 2px; width: 200px; background: var(--surface); box-shadow: var(--border-raised); display: none; flex-direction: column; padding: 4px 0; z-index: 300;}
        .start-menu button{all:unset;display:block;width:100%;padding:6px 10px;box-sizing:border-box;font-family:"Pixelated MS Sans Serif",Arial;font-size:12px;cursor:default;position:relative;white-space:nowrap;}
        .start-menu button:hover{background:var(--blue-light);color:#fff;}
        .submenu{position:absolute;top:0;left:100%;width:200px;background:var(--surface);box-shadow:var(--border-raised);display:none;flex-direction:column;padding:4px 0;z-index:400;}
        .has-submenu:hover>.submenu{display:flex;}
        .has-submenu::after{content:"â–¶";position:absolute;right:6px;}
    </style>
</head>
<body>
    <div class="desktop">
        <div class="desktop-icons">
            <div class="desktop-icon" id="internet-icon" tabindex="0" style="top: 10px; left: 10px;">
                <img src="https://win98icons.alexmeub.com/icons/png/msie1-0.png" alt="Internet Explorer">
                <span>Internet</span>
            </div>
            <div class="desktop-icon" id="paint-icon" tabindex="0" style="top: 80px; left: 10px;">
                <img src="page_images/paint_icon.webp" alt="Paint">
                <span>Paint</span>
            </div>
        </div>
        <div class="window" id="my-window" style="display: none; top: 100px; left: 150px; width: 400px; height: 300px; ">
            <div class="title-bar">
                <div class="title-bar-text">Internet Explorer</div>
                <div class="title-bar-controls">
                    <button aria-label="Minimize" class="minimize-btn"><svg width="10" height="10"><path d="M0 5H10"/></svg></button>
                    <button aria-label="Maximize" class="maximize-btn"><svg width="10" height="10"><path d="M0 0H10V10H0ZM1 1V9H9V1Z"/></svg></button>
                    <button aria-label="Close" class="close-btn"><svg width="10" height="10"><path d="M0 0L10 10M0 10L10 0"/></svg></button>
                </div>
            </div>
            <div class="window-body">
                <iframe id="ie-frame" src="searchbox.html" frameborder="0" style="width:100%; height:100%;"></iframe>
            </div>
        </div>
        <div class="window" id="paint-window" style="display: none; top: 150px; left: 200px; width: 500px; height: 350px;">
            <div class="title-bar">
                <div class="title-bar-text">Paint</div>
                <div class="title-bar-controls">
                    <button aria-label="Minimize" class="minimize-btn"><svg width="10" height="10"><path d="M0 5H10"/></svg></button>
                    <button aria-label="Maximize" class="maximize-btn"><svg width="10" height="10"><path d="M0 0H10V10H0ZM1 1V9H9V1Z"/></svg></button>
                    <button aria-label="Close" class="close-btn"><svg width="10" height="10"><path d="M0 0L10 10M0 10L10 0"/></svg></button>
                </div>
            </div>
            <div class="window-body">
                <iframe id="paint-frame" src="paint.html" frameborder="0" style="width:100%; height:100%;"></iframe>
            </div>
        </div>
    </div>
    <footer class="taskbar">
        <button class="start-button" id="start-btn">
            <img src="https://win98icons.alexmeub.com/icons/png/windows-0.png" alt="Start Icon">
            <span>Start</span>
        </button>
        <div class="vertical-separator"></div>
        <button class="taskbar-btn" id="taskbar-internet-btn" style="display: none;">Internet</button>
        <button class="taskbar-btn" id="taskbar-paint-btn" style="display: none;">Paint</button>
        <div class="time-date" id="time-date"></div>
    </footer>
    <div class="start-menu" id="start-menu">
        <div class="has-submenu"><button>Programs</button><div class="submenu"><div class="has-submenu"><button>Accessories</button><div class="submenu"><button>Games</button><button>Internet Tools</button><button>Multimedia</button><button>System Tools</button><button>Calculator</button><button>Character Map</button><button>Notepad</button><button>Paint</button><button>WordPad</button></div></div><button>StartUp</button><button>MS-DOS Prompt</button><button>Windows Explorer</button></div></div>
        <button>Documents</button><button>Settings</button><button>Find</button><button>Help</button><button>Run ...</button><button>Shut Down ...</button>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const timeDateEl = document.getElementById('time-date');
            const desktopEl = document.querySelector('.desktop');
            let maxZIndex = 101; 

            // Time Update Function
            function updateTime() {
                const now = new Date();
                const timeStr = now.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });
                const dateStr = now.toLocaleDateString('en-US', { month: '2-digit', day: '2-digit', year: 'numeric' });
                timeDateEl.textContent = `${timeStr} ${dateStr}`;
            }
            setInterval(updateTime, 1000);
            updateTime();

            // -----------------------------------------------------------
            // Z-Index Management Function (Bring to Front)
            // -----------------------------------------------------------
            function bringToFront(windowEl) {
                if (parseInt(windowEl.style.zIndex) < maxZIndex) {
                    maxZIndex += 1;
                    windowEl.style.zIndex = maxZIndex;
                }
            }

            // -----------------------------------------------------------
            // Window Management Function 
            // -----------------------------------------------------------
            function makeWindowInteractive(windowEl, taskbarBtn) {
                const titleBar = windowEl.querySelector('.title-bar');
                const [minBtn, maxBtn, closeBtn] = [
                    windowEl.querySelector('.minimize-btn'),
                    windowEl.querySelector('.maximize-btn'),
                    windowEl.querySelector('.close-btn')
                ];
                
                let isDragging = false;
                let dragOffsetX, dragOffsetY; 
                let lastPos = { top: windowEl.style.top, left: windowEl.style.left };
                let lastSize = { width: windowEl.style.width, height: windowEl.style.height };

                const showWindow = () => {
                    windowEl.style.display = 'flex';
                    taskbarBtn.style.display = 'block';
                    bringToFront(windowEl); 
                };
                
                const hideWindow = () => {
                    windowEl.style.display = 'none';
                };
                
                const closeWindow = () => {
                    windowEl.style.display = 'none';
                    taskbarBtn.style.display = 'none';
                    windowEl.classList.remove('maximized'); 
                };

                // CORE FIX: Click anywhere on the window to bring it to the front
                windowEl.addEventListener('mousedown', () => bringToFront(windowEl));

                // Drag Start
                titleBar.addEventListener('mousedown', e => {
                    if (windowEl.classList.contains('maximized')) return;
                    bringToFront(windowEl); 
                    isDragging = true;
                    windowEl.style.cursor = 'grabbing';
                    
                    dragOffsetX = e.clientX - windowEl.offsetLeft;
                    dragOffsetY = e.clientY - windowEl.offsetTop;

                    document.addEventListener('mousemove', drag);
                    e.preventDefault(); 
                });
                
                // Draggable Fix (includes boundary checks)
                function drag(e) {
                    if (!isDragging) return;
                    
                    let newLeft = e.clientX - dragOffsetX;
                    let newTop = e.clientY - dragOffsetY;

                    const desktopHeight = desktopEl.clientHeight;
                    const desktopWidth = desktopEl.clientWidth;

                    // Apply bounds
                    newLeft = Math.max(0, newLeft);
                    newTop = Math.max(0, newTop);
                    newLeft = Math.min(newLeft, desktopWidth - windowEl.offsetWidth);
                    newTop = Math.min(newTop, desktopHeight - windowEl.offsetHeight);

                    windowEl.style.left = `${newLeft}px`;
                    windowEl.style.top = `${newTop}px`;
                }
                
                // Drag End
                document.addEventListener('mouseup', () => {
                    if (isDragging) {
                        isDragging = false;
                        windowEl.style.cursor = 'grab';
                        document.removeEventListener('mousemove', drag);
                        lastPos = { top: windowEl.style.top, left: windowEl.style.left };
                    }
                });

                // Control Buttons and Taskbar
                closeBtn.addEventListener('click', closeWindow);
                minBtn.addEventListener('click', hideWindow);
                
                taskbarBtn.addEventListener('click', () => {
                    if (windowEl.style.display === 'none') {
                        showWindow();
                    } else {
                        hideWindow();
                    }
                });
                
                maxBtn.addEventListener('click', () => {
                    if (windowEl.classList.toggle('maximized')) {
                        lastPos = { top: windowEl.style.top, left: windowEl.style.left };
                        lastSize = { width: windowEl.style.width, height: windowEl.style.height };
                    } else {
                        Object.assign(windowEl.style, lastPos, lastSize);
                    }
                });

                return { showWindow, closeWindow };
            }

            // -----------------------------------------------------------
            // Initialize Windows
            // -----------------------------------------------------------

            // 1. Internet Explorer
            const ieWindowEl = document.getElementById('my-window');
            const ieIcon = document.getElementById('internet-icon');
            const taskbarInternetBtn = document.getElementById('taskbar-internet-btn');
            const ieControl = makeWindowInteractive(ieWindowEl, taskbarInternetBtn);
            ieIcon.addEventListener('dblclick', ieControl.showWindow);
            ieWindowEl.style.zIndex = maxZIndex;

            // 2. Paint
            const paintWindowEl = document.getElementById('paint-window');
            const paintIcon = document.getElementById('paint-icon');
            const taskbarPaintBtn = document.getElementById('taskbar-paint-btn');
            const paintControl = makeWindowInteractive(paintWindowEl, taskbarPaintBtn);
            paintIcon.addEventListener('dblclick', paintControl.showWindow);
            paintWindowEl.style.zIndex = maxZIndex + 1; 
            maxZIndex += 1; 


            // -----------------------------------------------------------
            // Start Menu Logic 
            // -----------------------------------------------------------
            const startBtn = document.getElementById('start-btn');
            const startMenu = document.getElementById('start-menu');
            
            startBtn.addEventListener('click', (e) => {
                e.stopPropagation(); 
                startMenu.style.display = startMenu.style.display === 'flex' ? 'none' : 'flex';
            });

            document.addEventListener('click', e => {
                if (!startBtn.contains(e.target) && !startMenu.contains(e.target)) {
                    startMenu.style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>