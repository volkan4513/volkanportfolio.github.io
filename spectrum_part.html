<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Audio Visualizer</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: #000;
    }
    #canvas {
      position: fixed;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
    }
    audio {
      position: fixed;
      left: 10px;
      bottom: 10px;
      width: calc(100% - 20px);
    }
  </style>
</head>
<body>

  <canvas id="canvas"></canvas>
  <audio id="audio" controls></audio>

  <script>
    window.onload = function () {
      var audio = document.getElementById("audio");
      
      // âœ… Auto-load from path (change this to your audio file)
      var defaultPath = "./music/twinleaf_town.mp3"; 
      audio.src = defaultPath;
      audio.load();

      function startVisualizer() {
        var context = new AudioContext();
        var src = context.createMediaElementSource(audio);
        var analyser = context.createAnalyser();

        var canvas = document.getElementById("canvas");
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        var ctx = canvas.getContext("2d");

        src.connect(analyser);
        analyser.connect(context.destination);

        analyser.fftSize = 256;

        var bufferLength = analyser.frequencyBinCount;
        var dataArray = new Uint8Array(bufferLength);

        var WIDTH = canvas.width;
        var HEIGHT = canvas.height;
        var barWidth = (WIDTH / bufferLength) * 2.5;
        var barHeight;
        var x = 0;

        function renderFrame() {
          requestAnimationFrame(renderFrame);
          x = 0;
          analyser.getByteFrequencyData(dataArray);

          ctx.fillStyle = "#000";
          ctx.fillRect(0, 0, WIDTH, HEIGHT);

          for (var i = 0; i < bufferLength; i++) {
            barHeight = dataArray[i];
            var r = barHeight + (25 * (i / bufferLength));
            var g = 250 * (i / bufferLength);
            var b = 50;

            ctx.fillStyle = "rgb(" + r + "," + g + "," + b + ")";
            ctx.fillRect(x, HEIGHT - barHeight, barWidth, barHeight);
            x += barWidth + 1;
          }
        }
        renderFrame();
      }

      // Start visualizer when audio plays
      audio.onplay = () => startVisualizer();
    };
  </script>

</body>
</html>
