<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Main Page with Menu + Tab Nav</title>
  <style>
    :root {
      --fs: clamp(28px, 6vw, 56px);
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    }

    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
    }

    body {
      overflow-y: hidden;
      scroll-behavior: auto;
      scroll-snap-type: y mandatory;
    }

    section {
      height: 100vh;
      display: flex;
      flex-direction: column;
      scroll-snap-align: start;
      -webkit-tap-highlight-color: transparent;
      user-select: none;
      padding-right: 30px;
      box-sizing: border-box;
    }

    section iframe {
      flex: 1;
      width: 100%;
      height: 100%;
      border: none;
    }

    .split-half {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: var(--fs);
    }

    .one .top {
      flex: 7;
    }

    .one .bottom {
      background: #222;
      color: #fff;
      flex: 3;
    }

    .two {
      background: #262626;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: var(--fs);
    }

    .three {
      background: #383838;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: var(--fs);
    }

    .four {
      background: #5d5d5d;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: var(--fs);
    }

    .dot-nav {
      position: fixed;
      top: 0;
      right: 0;
      height: 100%;
      width: 30px;
      background: #393939;
      display: flex;
      flex-direction: column;
      align-items: left;
      z-index: 9999;
    }

    .dot-nav button {
      width: 100%;
      height: auto;
      flex: 1;
      border: none;
      background: rgba(255, 255, 255, 0.3);
      cursor: pointer;
      transition: background 0.3s ease;
      box-shadow: 0 10px 5px rgba(0, 0, 0, 1);
      box-sizing: border-box;
      /* border: 2px solid #ffffff71; */
    }

    .dot-nav button span {
      writing-mode: vertical-lr;
      /* text-orientation: mixed; */
      transform: rotate(360deg);
      white-space: nowrap;
      font-size: 12px;
      color: #fff;
    }

    .dot-nav button.active {
      background: #1c1c1c;
      color: #000;
    }

    .menu-bar {
      position: fixed;
      top: 0;
      left: 0;
      right: 35px;
      background: rgba(43, 43, 43, 0.0025);
      margin: 5px;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 15px;
      font-size: 16px;
      font-weight: 600;
      z-index: 10000;
      backdrop-filter: blur(8px);
      box-shadow: 0 6px 0px rgba(0, 0, 0, 0.278);
      box-sizing: border-box;
    }


    .menu-left {
      font-size: 20px;
      letter-spacing: 1px;
    }

    .menu-right {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .menu-right button {
      background: transparent;
      border: 1px solid #fff;
      color: #fff;
      padding: 6px 14px;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.25s ease;
      box-shadow: 0 6px 0px rgba(0, 0, 0, 0.278);
    }

    .menu-right button:hover {
      background: #fff;
      color: #000;
    }

    .hamburger {
      display: none;
      flex-direction: column;
      justify-content: center;
      width: 26px;
      height: 22px;
      cursor: pointer;
      gap: 5px;
    }

    .hamburger span {
      display: block;
      height: 3px;
      width: 100%;
      background: #fff;
      border-radius: 2px;
    }

    .dropdown {
      display: none;
      flex-direction: column;
      position: absolute;
      right: 12px;
      top: 56px;
      background: rgba(43, 43, 43, 0.25);
      padding: 10px 14px;
      border-radius: 8px;
      backdrop-filter: blur(8px);
      box-shadow: 0 6px 0px rgba(0, 0, 0, 0.278);
      border: 1px solid #ffffff40;
      z-index: 10001;
    }

    .dropdown button {
      background: transparent;
      border: 1px solid #fff;
      color: #fff;
      padding: 8px 14px;
      margin: 6px 0;
      width: 140px;
      font-size: 14px;
      text-align: left;
      cursor: pointer;
      transition: all 0.25s ease;
      box-shadow: 0 6px 0px rgba(0, 0, 0, 0.278);
    }

    .dropdown button:hover {
      background: #fff;
      color: #000;
    }

    @media (max-width: 768px) {
      .menu-right {
        display: none;
      }

      .hamburger {
        display: flex;
      }
    }
  </style>
</head>

<body>
  <!-- Menu Bar -->
  <div class="menu-bar">
    <div class="menu-left">torquelore</div>

    <div class="menu-right">
      <button>work</button>
      <button>some more work</button>
      <button onclick="window.open('https://www.linkedin.com','_blank')">linkedin</button>
    </div>

    <div class="hamburger" id="hamburger">
      <span></span><span></span><span></span>
    </div>

    <div class="dropdown" id="dropdown">
      <button>work</button>
      <button>some more work</button>
      <button onclick="window.open('https://www.linkedin.com','_blank')">linkedin</button>
    </div>
  </div>

  <!-- Sections -->
  <section class="one">
    <div class="split-half top">
      <iframe src="unblur_page.html" scrolling="yes"></iframe>
    </div>
    <div class="split-half bottom">
      <iframe src="first_second_half.html" scrolling="yes"></iframe>
    </div>
  </section>
  <section class="two">
    <iframe src="lots_of_square_cursor.html" ></iframe>
  </section>
  <section class="three"><iframe src="floating_box.html" ></iframe></section>
  <section class="four">Section 4</section>

  <!-- Side Panel Dot Navigation -->
  <div class="dot-nav" aria-hidden="true">
  </div>

  <script>
    // ===== MENU TOGGLE =====
    const hamburger = document.getElementById('hamburger');
    const dropdown = document.getElementById('dropdown');

    hamburger.addEventListener('click', () => {
      dropdown.style.display = dropdown.style.display === "flex" ? "none" : "flex";
    });

    // ===== SNAP SCROLL SCRIPT =====
    (() => {
      const sections = [...document.querySelectorAll('section')], dotNav = document.querySelector('.dot-nav');
      let currentIndex = 0, isAnimating = false;
      const WHEEL_THRESHOLD = 40;

      // dot nav setup
      const tabLabels = ["HOME", "SECTION 2", "SECTION 3", "SECTION 4"];
      sections.forEach((_, i) => {
        const b = document.createElement('button');
        const span = document.createElement('span');
        span.textContent = tabLabels[i];        // add text
        b.appendChild(span);
        if (i === 0) b.classList.add('active');
        b.addEventListener('click', () => !isAnimating && goTo(i));
        dotNav.appendChild(b);
      });

      const dots = [...dotNav.children];

      const easeOutBack = t => 1 + 2.70158 * Math.pow(t - 1, 3) + 1.70158 * Math.pow(t - 1, 2);
      const nearestIndex = () => sections.map(s => Math.abs(s.offsetTop - scrollY)).indexOf(Math.min(...sections.map(s => Math.abs(s.offsetTop - scrollY))));
      const updateDots = i => dots.forEach((d, idx) => d.classList.toggle('active', idx === i));

      const animateTo = (index, duration = 700) => {
        isAnimating = true;
        const start = scrollY, target = sections[index].offsetTop, distance = target - start;
        let startTime = null;

        const frame = time => {
          if (!startTime) startTime = time;
          const elapsed = time - startTime;
          const t = Math.min(elapsed / duration, 1);
          window.scrollTo(0, Math.round(start + distance * easeOutBack(t)));
          if (elapsed < duration) requestAnimationFrame(frame);
          else {
            window.scrollTo(0, target);
            isAnimating = false;
            currentIndex = index;
            updateDots(currentIndex);
          }
        };
        requestAnimationFrame(frame);
      };

      const goTo = index => {
        index = Math.max(0, Math.min(index, sections.length - 1));
        if (index === currentIndex && Math.abs(scrollY - sections[index].offsetTop) < 2) return;
        animateTo(index);
      };

      // wheel
      window.addEventListener('wheel', e => {
        e.preventDefault();
        if (isAnimating) return;
        let delta = (e.deltaMode === 1 ? e.deltaY * 16 : e.deltaMode === 2 ? e.deltaY * innerHeight : e.deltaY);
        if (Math.abs(delta) > WHEEL_THRESHOLD) {
          if (delta > 0) goTo(currentIndex + 1);
          else goTo(currentIndex - 1);
        } else {
          const n = nearestIndex();
          if (n !== currentIndex) goTo(n);
        }
      }, { passive: false });

      // keyboard
      window.addEventListener('keydown', ev => {
        if (isAnimating) return;
        if (['ArrowDown', 'PageDown'].includes(ev.key)) { ev.preventDefault(); goTo(currentIndex + 1); }
        else if (['ArrowUp', 'PageUp'].includes(ev.key)) { ev.preventDefault(); goTo(currentIndex - 1); }
        else if (ev.key === 'Home') { ev.preventDefault(); goTo(0); }
        else if (ev.key === 'End') { ev.preventDefault(); goTo(sections.length - 1); }
      });

      // touch
      let touchStartY = null;
      window.addEventListener('touchstart', e => {
        if (e.touches && e.touches.length === 1)
          touchStartY = e.touches[0].clientY;
      }, { passive: true });

      window.addEventListener('touchend', e => {
        if (touchStartY === null || isAnimating) { touchStartY = null; return; }
        const diff = touchStartY - ((e.changedTouches && e.changedTouches[0] && e.changedTouches[0].clientY) || 0);
        const SWIPE_MIN = 40;
        const newIndex = diff > SWIPE_MIN ? currentIndex + 1 : diff < -SWIPE_MIN ? currentIndex - 1 : nearestIndex();
        if (newIndex !== currentIndex) goTo(newIndex);
        touchStartY = null;
      }, { passive: true });

      // scroll + resize sync
      let scrollDebounce = null;
      window.addEventListener('scroll', () => {
        if (isAnimating) return;
        clearTimeout(scrollDebounce);
        scrollDebounce = setTimeout(() => {
          const n = nearestIndex();
          if (n !== currentIndex) {
            currentIndex = n;
            updateDots(currentIndex);
          }
        }, 10);
      }, { passive: true });

      window.addEventListener('resize', () => {
        setTimeout(() => goTo(nearestIndex()), 120);
      });

      // initial alignment
      const alignOnLoad = () => {
        currentIndex = nearestIndex();
        setTimeout(() => goTo(currentIndex), 50);
      };

      document.addEventListener('DOMContentLoaded', alignOnLoad);
      if (document.readyState === 'complete' || document.readyState === 'interactive') alignOnLoad();
    })();
  </script>
</body>

</html>